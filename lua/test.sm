; -*- scheme -*-
; Subset of Scheme representing sm.h style protothreads.

;(let* ((a 123)
;       (b 345))
;      (add a b 1))

(module (testmod)

  (define (fun1)
    (let*
        ((a
          (let* ((b (read chan1))
                 (c (read chan1)))
            (add b c)))
         (d (read chan1))
         (e (let* ((x (add a (add 1 2)))
                   (y (add d 2)))
              (add x y)))
         (f 123) ;;(fun3 123))
         (g (let* ((l 5))
              (add f l))))
      (send d)
      (send e)
      (send f)
      (fun2)))

  (define (fun2)
    (fun1))

  (define (fun3 a)
    (let*
        ((b (read chan2)))
      (add a b)))

  )




